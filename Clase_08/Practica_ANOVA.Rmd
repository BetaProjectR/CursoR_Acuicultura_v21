---
title: "Guía de trabajo Análisis de varianza y posteriores"
subtitle: 'Curso Introducción al Análisis de datos con R para la acuicultura'
author:
 name: Dr. José A. Gallardo y Dra. María Angélica Rueda.
 affiliation: Pontificia Universidad Católica de Valparaíso
 email: <jose.gallardo@pucv.cl>
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  html_document:
    toc: true
    toc_float: true
    toc_depth: 3
    code_folding: hide
  word_document: default
  pdf_document: default
---

<style>
#TOC {
  color: black;
  font-familiy: Calibri;
  font-size: 14px;
  border-color: #708090; 
}
body {
   color: black;
   font-familiy: Calibri;
}

pre {
  color: black;
  background-color: #F8F8FF;
}
# header {
  color: #800000;
  font-familiy: Calibri;
  background-color: #F5F5F5;
  opacity: 0.8;
  font-size: 16px;
}
</style>

---

#### **Introducción**

**Análisis de Varianza**

**Comparación a posteriori**


#### **Objetivos de aprendizaje**

Los objetivos de aprendizaje de esta guía son:

**1**. - Elaborar hipótesis estadísticas.

**2**. - Realizar análisis de varianza y comparaciones posteriores. 

**3**. - Elaborar un reporte dinámico en formato pdf con **[Rmarkdown](https://rmarkdown.rstudio.com/)**.

#### Librerías

Alguna nueva ???

#### **Comandos**

A continuación, se presentan algunos comandos que deberá usar para resolver los ejercicios de esta guía.

**1.-** :**lm()**

**2.-**  :**aov()**

### **Ejercicio 1.** **Elaborar archivo Rmarkdown**

Usando lo aprendido en la unidad 1 del diplomado elabore y configure un archivo o file con extensión **.Rmd** y configurelo para exportar el resultado como un documento dinámico **pdf**.

Utilice el siguiente ejemplo para completar la información de metadatos: Título: Reporte inferencia estadística, nombre del autor: Su nombre.

Luego guarde inmediatamente su *script* como **script_9_nombre_apellido.Rmd**. Al finalizar la actividad deberá exportar y almacenar este script en su carpeta drive de tareas.

### **Ejercicio 2.** **Configuración del reporte**

En el primer bloque de códigos o **chunk** configure los comandos de la siguiente manera **_knitr::opts_chunk$set(echo = TRUE)_** y cargue las librerías  **stats**, **graphics**, **ggplot2**, **readxl**, **pander**, **dplyr** y **knitr**.

```{r setup, include=TRUE, warning=FALSE,message=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# Librería stats está instalada por defecto en la base de R
library(stats)

# Librería graphics está instalada por defecto en la base de R
library(graphics)

# Librería para gráficas avanzadas
library(ggplot2)

# Librería para importar datos
library(readxl)

# Librería para mostrar en formato tabla los resultados de un objeto
library(pander)

# Librería para usar funciones de tidyverse
library(dplyr)

# Librería para hacer tablas
library(knitr)

```

Ejecute cada uno de los siguientes ejercicios en uno o más bloques de códigos diferentes. Sea ordenado y documente su reporte adecuadamente.

RESUMEN
Ejercicio 3
ANOVA 1 VIA
1 variable respuesta y un factor con 2 niveles.

Simular ANOVA 1 via con transformación arcoseno de Survival (%).
https://scielo.conicyt.cl/scielo.php?pid=S0718-560X2019000300440&script=sci_arttext

Ejercicio 4
ANOVA 1 VIA
1 variable respuesta y un factor con 3 niveles.
+ comparaciones a posteriori

Simular 
One-way analysis of variance (ANOVA) was used to
determine the effects of ozonation on growth and
hematological parameters
https://fas.biomedcentral.com/articles/10.1186/s41240-017-0079-3


Ejercicio 5
ANOVA 2 VIAS
1 variable respuesta y dos factores con interacción.

Simular datos Fig. 2. Susceptibility (mortality) of Chinook salmon to Vibrio anguillarum.
Anova con interacción desde paper
https://doi.org/10.1016/j.aquaculture.2013.12.010

### **Ejercicio 3.**: **Prueba de hipótesis comparación más de dos muestras independientes**



Los datos **Tilapia_data.xlsx** se refieren a la longitud (**Longitud_cm**) y el peso (**Peso_g**) de 100 tilapias machos de cultivos provenientes del Ecuador.

**a).** Importe el set de datos **Tilapia_data.xlsx** usando la función **read_excel()** de la librería **readxl**, llame al objeto Tilapia. Explore el set de datos usando las funciones **head()**, **str()** y **summary()**.

```{r}
Tilapia <- read_excel("Tilapia_data.xlsx")
head(Tilapia)
str(Tilapia)
summary(Tilapia)
```

**b).** Realice un análisis exploratorio de datos de las variables bajo estudio. Incluya una tabla de los estimadores puntuales de los promedios y las varianzas de cada variable. Incluya un histograma de cada variable, use la función par(mfrow = c(1,2)). Finalmente elabore con ggplot2 un gráfico de dispersión de puntos para observar la relación lineal entre las variables Peso **_vs_** Longitud.

```{r, echo=TRUE, warning=FALSE,message=FALSE}
# Promedio y varianza de la variable Longitud
Promedio_Longitud <- mean(Tilapia$Longitud_cm)
Var_Longitud <- var(Tilapia$Longitud_cm)

# Promedio y varianza de la variable Peso
Promedio_Peso <- mean(Tilapia$Peso_g)
Var_Peso <- var(Tilapia$Peso_g)

# Histogramas de las variables Longitud y Peso
par(mfrow = c(1,2))
hist(Tilapia$Longitud_cm, main= "Hist Longitud", xlab= "Longitud (g)", ylim= c(0,30),col="cyan")
hist(Tilapia$Peso_g, main= "Hist Peso", xlab= "Peso (g)", ylim= c(0,30),col="dodgerblue")

# Gráfico de dispersión entre x e y
ggplot(Tilapia, aes(x=Tilapia$Longitud_cm, y=Tilapia$Peso_g))+
  geom_point()+
  ggtitle("Peso (g) vs Longitud (cm)") + geom_smooth(method=lm, se=FALSE)+ 
  scale_x_continuous(name = "Longitud (cm)", limits = c(10, 30), breaks = seq(10, 30, 5))+ 
  scale_y_continuous(name = "Peso (g)", limits = c(50,250), breaks = seq(50, 250, 50))+ 
  theme(plot.title = element_text(hjust = 0.5), panel.background = element_blank(), axis.line = element_line(color="black"), axis.line.x = element_line(color="black"))+ 
  theme_bw()

```

**c).** Escriba su hipótesis nula y alternativa para este experimento.


```{r}
# **H~0~**: $\rho$ = 0

# **H~1~**: $\rho$ $\ne$ 0
```

**d).** Realice una prueba de hipótesis para la correlación entre X e Y usando la función **cor.test()**, (llame al objecto cor_L_P) y obtenga los intervalos de confianza usando **cor.test()$conf.int** (llame a este objeto IC_cor_L_P) . Considere en **cor.test()** como nivel de confianza para la prueba el 95% y el método de Pearson. Para mostrar los resultados de la prueba de correlación usar la función **pander()** sobre el objeto **cor_L_P**, en el parámetro **_caption_** de la función **pander()** colocar "Prueba de hipótesis para el coeficiente de correlación entre Longitud y Peso.".

```{r, echo=TRUE}
cor_L_P<- cor.test(x=Tilapia$Longitud_cm , y=Tilapia$Peso_g , method = "pearson", conf.level = 0.95)
cor_L_P

IC_cor_L_P <-cor_L_P$conf.int
IC_cor_L_P

pander::pander(cor_L_P, caption = "Prueba de hipótesis para el coeficiente de correlación entre Longitud y Peso.")
```

**e).** Interprete los resultados.
```{r}
# De los resultados obtenidos de la prueba, se observa que el p-valor= 1.261e-73 es menor al nivel de significación del 5%; concluyendo que hay evidencia estadísticamente significativa para rechazar H0. Por lo tanto, la correlación entre la longitud y el peso es distinta de cero.  

```

ANOVA 2 VIAS
1 variable respuesta y 2 factores con 2 niveles.
